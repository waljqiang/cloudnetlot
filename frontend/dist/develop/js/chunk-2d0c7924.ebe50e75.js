(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c7924"],{"50d7":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{"element-loading-text":t.loading_txt,"element-loading-background":t.loading_bgcolor}},[a("div",{staticClass:"list_top_box align_r"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showDialog("add")}}},[t._v("添加产品")])],1),a("table-counter",{attrs:{column:t.column,thisdata:t.thisgedata,pagesizes:!1,pagelayout:t.pagelayout,pageoffset:t.pageoffset,pageindex:t.pageindex,total:t.total,ispage:t.ispage,tableheight:t.tableH,unchecked:!0},on:{listenPageIndex:t.setPageIndex,listenPageOffset:t.setPageOffset,listenCheckData:t.setCheckData,listenSort:t.setSort}}),a("el-dialog",{attrs:{title:t.dialogTitle,"close-on-click-modal":!1,visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{staticStyle:{width:"90%",margin:"0 auto"},attrs:{"label-width":"30%","label-position":"left",size:"mini"}},[a("el-form-item",{attrs:{label:"产品名称"}},[a("el-input",{model:{value:t.form.productname,callback:function(e){t.$set(t.form,"productname",e)},expression:"form.productname"}})],1),a("el-form-item",{attrs:{label:"产品类型"}},[a("el-select",{attrs:{disabled:"add"!=t.dialogAction},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-option",{attrs:{label:"路由器",value:1}})],1)],1),a("el-form-item",{attrs:{label:"产品型号"}},[a("el-input",{attrs:{disabled:"add"!=t.dialogAction},model:{value:t.form.size,callback:function(e){t.$set(t.form,"size",e)},expression:"form.size"}})],1),a("el-form-item",{attrs:{label:"产品描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.form.productdes,callback:function(e){t.$set(t.form,"productdes",e)},expression:"form.productdes"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.subDialog}},[t._v("确 定")])],1)],1)],1)},i=[],s=(a("b0c0"),a("ade3")),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{ref:"multipleTable",attrs:{"row-key":t.getRowKey,height:t.tableH,"empty-text":t.emptytext,"highlight-current-row":t.isrowcurrent,"row-class-name":t.tableRowClassName,"header-row-class-name":t.tableHeaderClass,"cell-class-name":t.tdClassName,data:t.tableData},on:{"sort-change":t.sortChange,"selection-change":t.handleSelectionChange}},[t._l(t.column,(function(e,o){return["selection"==e.type?a("el-table-column",{attrs:{"reserve-selection":!0,align:"left",prop:e.prop,type:e.type,"min-width":e.width,selectable:t.selectable}}):"id"==e.type?a("el-table-column",{attrs:{align:"left",type:"index",label:e.name,width:"70px",sortable:e.sortable},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s((t.pageindex-1)*t.pageoffset+e.$index+1)+" ")]}}],null,!0)}):a("el-table-column",{attrs:{type:e.type,align:"left",prop:e.sortData,label:e.name,"min-width":e.width,sortable:e.sortable,"show-overflow-tooltip":!1},scopedSlots:t._u([{key:"default",fn:function(o){return[a("div",{domProps:{innerHTML:t._s(o.row[e.prop])}})]}}],null,!0)})]}))],2),[t.ispage?a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],staticClass:"tableAlign ",attrs:{background:"",small:"","current-page":t.pageindex,"page-size":t.pageoffset,"page-sizes":t.sizes,layout:t.pagelayout,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()]],2)},l=[],r=(a("4160"),a("159b"),{props:["column","thisdata","pagesizes","pagelayout","pageoffset","pageindex","total","ispage","tableheight","unchecked","rowcurrent"],data:function(){return{tableData:[],tableH:this.tableheight?this.tableheight:40*(this.pageoffset+1),isrowcurrent:!!this.rowcurrent,getRowKeys:function(t){return t.m_sn},sizes:[globalPageOffset,30,50,100],emptytext:this.$t("msg.emptytext")}},mounted:function(){this.$nextTick((function(){this.addTrList()}))},watch:{thisdata:function(t,e){this.$refs.multipleTable.clearSelection(),this.addTrList()},pageindex:function(t,e){this.$refs.multipleTable.clearSelection(),this.addTrList()},pageoffset:function(t,e){this.$refs.multipleTable.clearSelection(),this.addTrList()}},methods:{getRowKey:function(t){return t.id},tableHeaderClass:function(){return"table_header"},indexMethod:function(t){var e=(this.pageindex-1)*this.pageoffset+1;return e+t},tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2==0?"tr_even row_style":"tr_odd row_style"},tdClassName:function(t){var e=t.row;t.column,t.rowIndex,t.columnIndex;if(!e.istruedata)return"dom_off"},sortChange:function(t){this.$emit("listenSort",t)},handleSizeChange:function(t){this.$emit("listenPageOffset",t)},handleCurrentChange:function(t){this.$emit("listenPageIndex",t)},handleSelectionChange:function(t){this.$emit("listenCheckData",t)},selectable:function(t){return this.unchecked?0==t.state?0:(t.state,1):1},toggleSelection:function(t){var e=this;t.forEach((function(t){1==t.ischecked&&e.$refs.multipleTable.toggleRowSelection(t)}))},addTrList:function(){this.tableData=[];for(var t=0;t<this.thisdata.length;t++){var e=this.thisdata[t];this.total-t>0&&e?this.tableData.push(this.thisdata[t]):this.ispage}this.toggleSelection(this.tableData)}}}),c=r,d=a("2877"),u=Object(d["a"])(c,n,l,!1,null,"60bd6a6f",null),p=u.exports,f=a("b775");function h(t){return Object(f["a"])({url:"backend/develop/product/list",method:"post",data:t})}function g(t){return Object(f["a"])({url:"backend/develop/product/register",method:"post",data:t})}function m(t){return Object(f["a"])({url:"backend/develop/product/save",method:"post",data:t})}function b(t){return Object(f["a"])({url:"backend/develop/product/info",method:"get",params:t})}function y(t){return Object(f["a"])({url:"backend/develop/product/delete",method:"post",data:t})}function w(t){return Object(f["a"])({url:"backend/develop/product/publish",method:"post",data:t})}var v={data:function(){var t;return{fullscreenLoading:!1,loading_txt:"请稍后……",loading_bgcolor:"rgba(0, 0, 0, 0.7)",column:[{name:"",width:"5%",type:"selection"," code":"",prop:"",sortable:!1},(t={name:this.$t("common.list_sn"),width:"5%"},Object(s["a"])(t,"width","50"),Object(s["a"])(t,"type","id"),Object(s["a"])(t,"prop",""),Object(s["a"])(t,"sortable",!1),t),{name:"产品名称",width:"17%",type:"",prop:"name",sortable:"custom",sortData:"name"},{name:"产品类型",width:"17%",type:"",prop:"type_txt",sortable:"custom",sortData:"type"},{name:"产品型号",width:"16%",type:"",prop:"size",sortable:"custom",sortData:"size"},{name:"状态",width:"15%",type:"",prop:"status_txt",sortable:"custom",sortData:"status"},{name:"创建时间",width:"15%",type:"",prop:"created_at",sortable:"custom",sortData:"created_at"},{name:"操作",width:"10%",type:"",prop:"config_btn",sortable:!1}],thisgedata:[],pageoffset:10,pagelayout:"total,sizes, prev, pager, next, jumper",pageindex:1,total:0,ispage:!0,tableH:0,order_field:"created_at",order_sort:"desc",check_data:[],dialogVisible:!1,dialogAction:"",dialogTitle:"",actionIndex:"",form:{}}},components:{"table-counter":p},methods:{setSort:function(t){"ascending"==t.order?this.order_sort="asc":this.order_sort="desc",this.order_field=t.prop,this.getList()},setCheckData:function(t){this.check_data=t},setPageOffset:function(t){this.pageoffset=t,this.getList()},setPageIndex:function(t){this.pageindex=t,this.getList()},getList:function(){var t=this,e={pageIndex:this.pageindex,pageOffset:this.pageoffset,sortKey:this.order_field,sort:this.order_sort,keyword:""};h(e).then((function(e){if(t.fullscreenLoading=!1,1e4==e.status){var a=e.data;t.handleTable(a.list,a.total)}else t.$message({message:t.$t("msg.get_loading_error"),type:"error",offset:100})})).catch((function(e){t.fullscreenLoading=!1}))},handleTable:function(t,e){for(var a=this,o=0;o<t.length;o++){t[o]["istruedata"]=!0,1==t[o].type&&(t[o].type_txt="路由器");var i="",s="",n="";1==t[o].status?(t[o].status_txt="未发布",n='<button type="primary" icon="el-icon-setting" onclick="publishProduct(\''+t[o].prtid+"')\" >发布</button>",i='<button type="primary" onclick="del(\''+t[o].prtid+'\')" icon="el-icon-delete">删除</button>',s='<button type="primary" icon="el-icon-setting" onclick="showDialog(\'edit\',\''+t[o].prtid+"')\" >编辑</button>"):2==t[o].status?t[o].status_txt="等待审核中":3==t[o].status?(t[o].status_txt="发布失败",i='<button type="primary" onclick="del(\''+t[o].prtid+'\')" icon="el-icon-delete">删除</button>',s='<button type="primary" icon="el-icon-setting" onclick="showDialog(\'edit\',\''+t[o].prtid+"')\" >编辑</button>"):4==t[o].status&&(t[o].status_txt="发布成功",i='<button type="primary" onclick="del(\''+t[o].prtid+'\')" icon="el-icon-delete">删除</button>',s='<button type="primary" icon="el-icon-setting" onclick="showDialog(\'edit\',\''+t[o].prtid+"')\" >编辑</button>"),t[o].config_btn="<div>"+i+s+n+"</div>"}a.total=parseInt(e),a.thisgedata=t},handleClose:function(){this.dialogVisible=!1},showDialog:function(t,e,a){var o=this;this.dialogAction=t,this.actionIndex=a,"add"==t?(this.dialogTitle="添加",this.form={productname:"",type:1,size:"",productdes:""}):(this.dialogTitle="编辑",b({prtid:e}).then((function(t){1e4==t.status&&(o.form={productname:t.data.name,type:t.data.type,size:t.data.size,productdes:t.data.describe,prtid:t.data.prtid})})).catch((function(t){}))),this.dialogVisible=!0},subDialog:function(){var t=this;this.fullscreenLoading=!0,"add"==this.dialogAction?g(this.form).then((function(e){1e4==e.status?(t.$message({message:"添加成功",type:"success",offset:100}),t.getList(),t.dialogVisible=!1):t.$message({message:"添加失败",type:"success",offset:100}),t.fullscreenLoading=!1})).catch((function(e){t.fullscreenLoading=!1})):m(this.form).then((function(e){1e4==e.status?(t.$message({message:"修改成功",type:"success",offset:100}),t.getList(),t.dialogVisible=!1):t.$message({message:"修改失败",type:"error",offset:100}),t.fullscreenLoading=!1})).catch((function(e){t.fullscreenLoading=!1}))},del:function(t){var e=this;this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.fullscreenLoading=!0,y({prtid:t}).then((function(t){1e4==t.status?(e.$message({message:"删除成功",type:"success",offset:100}),e.getList()):e.$message({message:"删除失败",type:"error",offset:100}),e.fullscreenLoading=!1})).catch((function(t){e.fullscreenLoading=!1}))})).catch((function(){}))},publishProduct:function(t){var e=this;this.fullscreenLoading=!0,w({prtid:t}).then((function(t){1e4==t.status?(e.$message({message:"发布成功",type:"success",offset:100}),e.getList()):e.$message({message:"发布失败",type:"error",offset:100}),e.fullscreenLoading=!1})).catch((function(t){e.fullscreenLoading=!1}))}},beforeMount:function(){},mounted:function(){this.$nextTick((function(){this.fullscreenLoading=!0,this.getList(),window.showDialog=this.showDialog,window.del=this.del,window.publishProduct=this.publishProduct}))},beforeDestroy:function(){window.showDialog=void 0,window.del=void 0,window.publishProduct=void 0}},x=v,_=Object(d["a"])(x,o,i,!1,null,"d573b424",null);e["default"]=_.exports}}]);